<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="gov.nih.nci.calab.domain">
	<class name="LabFile" table="Lab_File">
		<cache usage="read-write" />
		<id name="id" type="java.lang.Long" column="FILE_PK_ID"
			unsaved-value="0">
			<generator class="org.hibernate.id.TableHiLoGenerator">
				<param name="table">hibernate_unique_key</param>
				<param name="column">next_hi</param>
			</generator>
		</id>
		<discriminator column="FILE_SOURCE_TYPE" type="string" />
		<property name="extension" type="java.lang.String"
			column="FILE_TYPE_EXTENSION" />
		<property name="createdBy" type="java.lang.String"
			column="CREATED_BY" />
		<property name="createdDate" type="java.util.Date"
			column="CREATED_DATE" />
		<property name="version" type="java.lang.String"
			column="VERSION" />
		<property name="uri" type="java.lang.String" column="FILE_URI" />
		<property name="filename" type="java.lang.String"
			column="FILE_NAME" />
		<property name="title" type="java.lang.String" column="TITLE" />
		<property name="description" type="java.lang.String"
			column="DESCRIPTION" />
		<property name="comments" type="java.lang.String"
			column="COMMENTS" />
		<property name="type" type="java.lang.String" column="TYPE" />
		<joined-subclass name="gov.nih.nci.calab.domain.OutputFile"
			table="RUN_OUTPUT_FILE">
			<key column="OUTPUT_FILE_PK_ID" />
			<many-to-one name="run" class="gov.nih.nci.calab.domain.Run"
				column="RUN_PK_ID" />
			<many-to-one name="dataStatus"
				class="gov.nih.nci.calab.domain.DataStatus"
				column="DATA_STATUS_PK_ID" />
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.SampleSOPFile"
			table="VIEW_SAMPLE_SOP_FILE">
			<key column="SOP_FILE_PK_ID" />
			<many-to-one name="sampleSOP"
				class="gov.nih.nci.calab.domain.SampleSOP"
				column="SAMPLE_SOP_PK_ID" />
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.InputFile"
			table="RUN_INPUT_FILE">
			<key column="INPUT_FILE_PK_ID" />
			<many-to-one name="run" class="gov.nih.nci.calab.domain.Run"
				column="RUN_PK_ID" />
			<many-to-one name="dataStatus"
				class="gov.nih.nci.calab.domain.DataStatus"
				column="DATA_STATUS_PK_ID" />
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.nano.characterization.DerivedBioAssayData"
			table="DERIVED_BIOASSAY_DATA">
			<key column="DERIVED_BIOASSAY_DATA_PK_ID" />
			<array name="categories" table="BIOASSAY_DATA_DATA_CATEGORY"> 
				<key column="DERIVED_BIOASSAY_DATA_PK_ID"></key> 
				<index column="CATEGORY_INDEX"></index> 
				<element column="CATEGORY_NAME" type="string" /> 
			</array>  			
			<list name="datumCollection" cascade="all-delete-orphan" lazy="true">
			<cache usage="read-write" />
			<key column="DERIVED_BIOASSAY_DATA_PK_ID" />
			<list-index column="LIST_INDEX" />
			<one-to-many class="gov.nih.nci.calab.domain.nano.characterization.Datum" />
		    </list>
			<set name="keywordCollection" table="KEYWORD_BIOASSAY_DATA"
				cascade="all-delete-orphan" lazy="false">
				<cache usage="read-write" />
				<key column="DERIVED_BIOASSAY_DATA_PK_ID" />
				<many-to-many class="gov.nih.nci.calab.domain.Keyword"
					column="KEYWORD_PK_ID" />
			</set>
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.AssociatedFile"
			table="ASSOCIATED_FILE">
			<key column="ASSOCIATED_FILE_PK_ID" />
			<set name="particleCollection"
				table="SAMPLE_ASSOCIATED_FILE" cascade="all-delete-orphan"
				lazy="true">
				<cache usage="read-write" />
				<key column="FILE_PK_ID" />
				<many-to-many
					class="gov.nih.nci.calab.domain.nano.particle.Nanoparticle"
					column="SAMPLE_PK_ID" />
			</set>
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.Report"
			table="REPORT">
			<key column="REPORT_PK_ID" />
			<set name="particleCollection" table="SAMPLE_REPORT"
				cascade="all-delete-orphan" lazy="true">
				<cache usage="read-write" />
				<key column="FILE_PK_ID" />
				<many-to-many
					class="gov.nih.nci.calab.domain.nano.particle.Nanoparticle"
					column="SAMPLE_PK_ID" />
			</set>
		</joined-subclass>
		<joined-subclass name="gov.nih.nci.calab.domain.ProtocolFile"
			table="PROTOCOL_FILE">
			<key column="PROTOCOL_FILE_PK_ID" />
			<many-to-one name="protocol"
				class="gov.nih.nci.calab.domain.Protocol" column="PROTOCOL_PK_ID"
				not-null="true" lazy="false"/>
		</joined-subclass>
	</class>
</hibernate-mapping>

